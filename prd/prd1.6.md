# 产品需求文档：前端应用搭建与审核工作台 - V1.6

## 1. 綜述 (Overview)
### 1.1 项目背景与核心问题
随着后台各版本（V1.2-V1.5）API的设计完成，现在需要构建一个正式的、生产级别的前端应用，以承载核心的人工审核功能。V1.6版本的核心目标是搭建前端应用的基础框架，实现基于账户控制的场景隔离登录流程，并交付第一个核心功能页面——“统一审核工作台”。该版本将是用户与系统交互的第一个正式入口，是整个知识库生产流程中“人工质检”环节的具象化实现。

### 1.2 核心业务流程 / 用户旅程地图
V1.6版本定义了一个完整的最小可用产品（MVP）的用户路径：
1.  **阶段一：登录与认证** - 用户（如“水务审核员”）在统一登录页面输入凭证。系统后台验证其身份，并识别其绑定的业务场景。
2.  **阶段二：进入工作台** - 登录成功后，用户进入“审核工作台”主界面。界面中加载并显示的，是且仅是该用户所属业务场景的待审核FAQ列表。
3.  **阶段三：审核操作** - 用户在工作台页面上，使用“内联展开式审核”交互模式，高效地对FAQ进行采纳、编辑或废弃操作。

## 2. 用户故事详述 (User Stories)

### 阶段一：登录认证与审核工作台

---

#### **US-1.6.1: 作为一名授权用户，我希望能通过账号密码登录系统，以便系统能识别我的身份和业务范围，并安全地访问我权限内的数据。**
*   **价值陈述 (Value Statement)**:
    *   **作为** 一名授权用户（审核员/管理员）
    *   **我希望** 通过一个安全的登录流程来访问系统
    *   **以便于** 系统能够自动将我的工作环境隔离在我所属的业务场景内（如“水务”或“公交”），确保数据的安全与专注。
*   **业务规则与逻辑 (Business Logic)**:
    1.  **用户管理**:
        *   系统不提供面向用户的注册功能。所有用户账户由管理员通过直接操作数据库的方式手动创建。
        *   创建用户时，必须明确指定其`username`, `password_hash`, 和绑定的`scenario_id`。
        *   所有用户的初始密码统一为`ct2025`，并在数据库中以哈希值形式存储。
    2.  **登录流程**:
        *   前端在统一登录页接收用户输入的`username`和`password`。
        *   调用后台`login` API进行验证。
        *   后端通过哈希比对验证密码。成功后，生成包含`userId`, `username`, `role`, `scenarioId`等信息的JWT。
        *   前端接收并安全存储JWT。
    3.  **授权机制**:
        *   前端需设置全局API请求拦截器，在后续所有对后台的请求中，自动在`Authorization`请求头中附带JWT。
*   **验收标准 (Acceptance Criteria)**:
    *   **场景1: 水务用户成功登录**
        *   **GIVEN** 数据库中存在一个绑定到“水务”场景的有效用户
        *   **WHEN** 该用户在登录页输入正确的用户名和密码`ct2025`
        *   **THEN** 他应该能成功登录，系统应跳转到主界面，且后续所有数据显示的都应是水务相关内容。
    *   **场景2: 登录失败**
        *   **GIVEN** 一个用户输入了错误的密码
        *   **WHEN** 他点击登录
        *   **THEN** 页面应提示“用户名或密码错误”，并停留在登录页。

---

#### **US-1.6.2: 作为一名审核员，我希望能在一个高效的界面上完成所有审核操作，以便快速处理AI提取的FAQ建议。**
*   **价值陈述 (Value Statement)**:
    *   **作为** 一名审核员
    *   **我希望** 使用一个“内联展开式审核”的工作台
    *   **以便于** 在不离开主列表的情况下，快速完成对FAQ的直接采纳、展开编辑和废弃操作，最大化提升工作效率。
*   **业务规则与逻辑 (Business Logic)**:
    1.  **数据加载**: 页面加载时，自动调用`GET /api/v1.4/pending-faqs` API，获取当前用户场景下的待审核列表。
    2.  **核心交互**:
        *   用户可以直接点击【✔ 直接采纳】，前端调用`POST /api/v1.4/knowledge-items`，成功后该列表项移除。
        *   用户可以点击【✖ 废弃】，前端调用`DELETE /api/v1.4/pending-faqs/{id}`，成功后该列表项移除。
        *   用户可以点击【展开/编辑】，当前行下方以内联方式展开编辑面板，面板内包含完整的、可编辑的Q&A输入框和原始对话参考。
        *   在展开面板内点击【保存并采纳】，前端调用`POST /api/v1.4/knowledge-items`并附带修改后的数据。
*   **验收标准 (Acceptance Criteria)**:
    *   **场景1: 展开并编辑**
        *   **GIVEN** 我在审核工作台列表
        *   **WHEN** 我点击某一项的【展开/编辑】按钮
        *   **THEN** 该项下方应平滑展开一个编辑面板，且不发生页面跳转。
    *   **场景2: 成功采纳**
        *   **GIVEN** 我在审核工作台列表
        *   **WHEN** 我点击【✔ 直接采纳】按钮，且API调用成功
        *   **THEN** 页面应弹出“采纳成功”的提示，并且该列表项应伴随动画效果从列表中消失。

---
*   **技术实现概要 (Technical Implementation Brief)**:
    *   **前端技术栈**:
        *   **框架**: React
        *   **UI组件库**: Ant Design
        *   **状态管理**: Zustand (用于管理用户认证信息)
        *   **数据请求**: Axios (配合SWR或React Query)
    *   **页面布局线框图 (审核工作台)**:
        ```text
        <!-- 状态一：默认列表 (用于快速决策) -->
        +--------------------------------------------------------------------------------------------------+
        | FAQ 智能挖掘系统      当前知识库: [ 水务知识库 ]                     [用户: 水务管理员 v] |
        +==================================================================================================+
        | 审核工作台                                                                                       |
        +--------------------------------------------------------------------------------------------------+
        | +------------------------------------+--------------------------------+-------------------------+ |
        | | 问题摘要                           | 答案摘要                       | 操作                    | |
        | +------------------------------------+--------------------------------+-------------------------+ |
        | | 如何查询上个月的水费账单？         | 您可以在APP的“历史账单”中查...   | [✔采纳] [展开] [✖废弃] | |
        | +------------------------------------+--------------------------------+-------------------------+ |
        
        <!-- 状态二：点击“展开”后的状态 (用于编辑和查看细节) -->
        | +------------------------------------+--------------------------------+-------------------------+ |
        | | 我家水管漏水了，应该联系哪个部门？ | 您可以拨打24小时报修热线963... | [✔采纳] [展开] [✖废弃] | |
        | +------------------------------------------------------------------------------------------------+ |
        | |  ▼  该行已展开                                                                                   | |
        | | +--------------------------------------------------------------------------------------------+ | |
        | | |  ... (此处为可编辑的Q&A输入框和原始对话参考) ...                                         | | |
        | | |                                                                 [ 保存并采纳 ] [ 取消 ]  | | |
        | | +--------------------------------------------------------------------------------------------+ | |
        | +------------------------------------------------------------------------------------------------+ |
        ```
    *   **数据库依赖 (后台)**:
        *   **`users` 表**: 用于存储用户账户信息。
        ```sql
        CREATE TABLE `users` (
          `id` int NOT NULL AUTO_INCREMENT,
          `username` varchar(50) NOT NULL,
          `password_hash` varchar(255) NOT NULL,
          `full_name` varchar(100) DEFAULT NULL,
          `scenario_id` int NOT NULL COMMENT '绑定的场景ID',
          `role` varchar(20) NOT NULL DEFAULT 'auditor',
          `is_active` tinyint(1) NOT NULL DEFAULT 1,
          PRIMARY KEY (`id`),
          UNIQUE KEY `uk_username` (`username`)
        );
        ```
    *   **API 依赖 (后台)**:
        *   `POST /api/v1.6/auth/login`: 用于处理登录请求。
        *   `GET /api/v1.4/pending-faqs`: 用于获取待审核列表。
        *   `POST /api/v1.4/knowledge-items`: 用于采纳FAQ。
        *   `DELETE /api/v1.4/pending-faqs/{id}`: 用于废弃FAQ。