# 产品需求文档：正式知识库管理页面 - V1.7

## 1. 綜述 (Overview)
### 1.1 项目背景与核心问题
随着V1.6版本实现了核心的“审核工作台”，系统能够持续产出审核通过的正式知识条目。为形成管理闭环，现在需要为管理员和审核员提供一个功能完善的后台界面，用于对这些已入库的“成品”知识进行统一的查看、维护和生命周期管理。V1.7版本的核心目标是开发“正式知识库管理”页面，为用户提供查询、编辑和状态管理（启用/禁用）的能力，确保知识库内容的准确性和时效性，并为V1.3的AICO同步服务提供一个干净、可靠的数据源头。

### 1.2 核心业务流程 / 用户旅程地图
V1.7版本聚焦于知识入库后的管理阶段，其核心用户旅程如下：
1.  **阶段一：查询与定位** - 管理员进入“知识库管理”页面，通过状态页签（已生效/已禁用）和关键词搜索，快速找到需要管理的知识条目。
2.  **阶段二：内容维护** - 对于需要更新内容的知识，管理员通过“编辑”功能，在弹出的模态框中修改问答文本并保存。
3.  **阶段三：状态管理** - 对于需要临时下线或重新上线的知识，管理员通过“禁用”/“启用”按钮，快速切换其状态，以控制其是否被同步至AICO平台。

## 2. 用户故事详述 (User Stories)

### 阶段一：知识库管理

---

#### **US-1.7: 作为一名管理员或审核员，我希望能方便地管理所有已审核通过的知识，以便进行内容更新和状态维护。**
*   **价值陈述 (Value Statement)**:
    *   **作为** 一名管理员或审核员
    *   **我希望** 能在一个统一的界面上，对所有正式知识进行搜索、编辑、禁用和重新启用
    *   **以便于** 应对业务变化，修正错误，管理知识的生命周期，确保最终同步到AICO的知识库是准确和最新的。
*   **业务规则与逻辑 (Business Logic)**:
    1.  **数据隔离**: 页面加载的所有数据，都必须严格遵循当前登录用户的场景隔离（水务/公交）。前端在调用所有API时，都需携带认证Token。
    2.  **默认视图**: 进入页面时，默认显示“已生效”状态的知识列表。
    3.  **筛选逻辑**:
        *   点击状态页签（Tabs），前端需调用`GET /api/v1.4.1/knowledge-items`并附带对应的`status`查询参数来刷新列表。
        *   使用关键词搜索时，前端需调用同一API并附带`keyword`查询参数。
    4.  **编辑逻辑**:
        *   点击【编辑】按钮，应弹出一个模态框（Modal）。
        *   为保证编辑的是最新数据，建议在打开模态框前，先调用`GET /api/v1.4.1/knowledge-items/{id}`获取单条最新详情。
        *   保存时，调用`PUT /api/v1.4.1/knowledge-items/{id}`，请求体中包含修改后的`question`和`answer`。
    5.  **状态变更逻辑**:
        *   点击【禁用】，调用`PUT /api/v1.4.1/knowledge-items/{id}`，请求体为`{"status": "disabled"}`。
        *   点击【启用】，调用`PUT /api/v1.4.1/knowledge-items/{id}`，请求体为`{"status": "active"}`。
        *   操作成功后，前端需刷新列表，以体现数据的状态迁移。
*   **验收标准 (Acceptance Criteria)**:
    *   **场景1: 成功禁用一条知识**
        *   **GIVEN** 我在“已生效”列表中，看到一条ID为58的知识
        *   **WHEN** 我点击该行的【禁用】按钮，并在确认提示中点击“确定”
        *   **THEN** 该行应从“已生效”列表中消失，页面弹出“禁用成功”的提示，并且当我切换到“已禁用”页签时，能看到ID为58的这条知识。
    *   **场景2: 成功编辑一条知识**
        *   **GIVEN** 我点击【编辑】按钮，打开了编辑模态框
        *   **WHEN** 我修改了答案文本，并点击【保存】
        *   **THEN** 模态框应关闭，页面弹出“更新成功”的提示，并且列表中的对应条目应显示更新后的“答案摘要”。

---
*   **技术实现概要 (Technical Implementation Brief)**:
    *   **前端技术栈**: React + Ant Design
    *   **核心组件**:
        *   `Tabs` (页签): 用于切换“已生效”/“已禁用”状态。
        *   `Input.Search` (搜索框): 用于关键词搜索。
        *   `Table` (表格): 用于展示知识列表及操作按钮。
        *   `Modal` (模态框): 用于承载编辑表单。
        *   `Form` (表单): 用于在模态框中进行内容编辑。
        *   `message` / `notification`: 用于操作后的全局提示。
    *   **页面布局线框图 (ASCII Wireframe)**:
        ```text
        +------------------------------------------------------------------------------------------+
        | FAQ 智能挖掘系统      当前知识库: [ 水务知识库 ]                     [用户: 水务管理员 v] |
        +==========================================================================================+
        | 知识库管理                                                                               |
        |------------------------------------------------------------------------------------------|
        |                                                                                          |
        |  [ 按问题或答案关键词搜索...      ]  [ 搜索 ]  [ 重置 ]                                     |
        |                                                                                          |
        +------------------------------------------------------------------------------------------+
        |                                                                                          |
        |   [ 已生效 (256) ]  [ 已禁用 (12) ]                                                      |
        |  +---------------------------------------------------------------------------------------+ |
        |  |                                                                                       | |
        |  | +----------------------+--------------------------+------------+-------------------+ | |
        |  | | 问题                 | 答案摘要                 | 最后更新   | 操作              | | |
        |  | +----------------------+--------------------------+------------+-------------------+ | |
        |  | | 如何查询个人用水户号？ | 提供户主姓名与准确用水地址后... | 2024-10-28 | [ 编辑 ] [ 禁用 ] | | |
        |  | +----------------------+--------------------------+------------+-------------------+ | |
        |  | | ...                  | ...                      | ...        | ...               | | |
        |  | +----------------------+--------------------------+------------+-------------------+ | |
        |  |                                                                                       | |
        |  |                                         << 上一页 | 第 [ 1 ] 页 / 共 26 页 | 下一页 >> | |
        |  |                                                                                       | |
        |  +---------------------------------------------------------------------------------------+ |
        |                                                                                          |
        +------------------------------------------------------------------------------------------+
        ```
    *   **API 依赖 (后台)**:
        *   `GET /api/v1.4.1/knowledge-items`: 用于获取知识列表（支持分页、状态筛选、关键词搜索）。
        *   `GET /api/v1.4.1/knowledge-items/{id}`: (推荐) 用于获取单条详情以供编辑。
        *   `PUT /api/v1.4.1/knowledge-items/{id}`: 用于保存编辑内容或变更状态。

*   **约束与边界 (Constraints & Boundaries)**:
    *   本页面不提供“新增”知识的功能，新增的唯一入口是“审核工作台”的采纳操作。
    *   本页面不提供“物理删除”功能，废弃知识的唯一方式是“禁用”。