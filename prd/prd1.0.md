# 产品需求文档：智能知识库挖掘与扩充系统 - V1.0

## 1. 综述 (Overview)
### 1.1 项目背景与核心问题
当前，水务公交场景下每日产生海量的客户服务对话，其中蕴含着大量未被发掘的客户高频问题和优质解答。知识库的更新完全依赖运营人员手动整理和自觉录入，缺乏系统性流程。这导致了知识库更新效率低下、内容覆盖面窄、对热点问题的响应时效性差等问题。本项目的核心目标是构建一个智能化的知识库扩充系统，通过AI技术自动从对话中挖掘有价值的Q&A，建立一套“AI挖掘-人工审核-一键入库”的标准化流程，从而显著提升知识库的丰富度、准确性和时效性。

### 1.2 核心业务流程 / 用户旅程地图
V1.0 版本聚焦于为知识库审核员打造一个高效的工作闭环。其核心用户旅程分为以下三个阶段：
1.  **阶段一：任务处理** - 审核员在工作台查看并处理由AI系统自动挖掘、去重后生成的待审核FAQ列表。
2.  **阶段二：审核决策** - 审核员审阅单条FAQ的详情，参考原始对话上下文，对AI生成的Q&A进行编辑、采纳或废弃。
3.  **阶段三：知识维护** - 审核员对所有已入库的正式知识进行日常的查询、编辑和状态管理（启用/禁用）。

## 2. 用户故事详述 (User Stories)

### 阶段一：任务处理

---

#### **US-01: 作为知识库审核员，我希望在一个清晰的仪表板上看到所有等待我处理的FAQ，以便于我能高效地开始一天的工作。**
*   **价值陈述 (Value Statement)**:
    *   **作为** 知识库审核员
    *   **我希望** 查看一个经过AI预处理的、无重复的待审核FAQ列表
    *   **以便于** 快速了解当前的工作量并逐一处理新知识。
*   **业务规则与逻辑 (Business Logic)**:
    1.  **前置条件**: 用户已登录系统。
    2.  **操作流程 (Happy Path)**:
        1. 用户进入“FAQ审核工作台”页面。
        2. 页面顶部展示“待审核总数”和“今日新增”的统计数据。
        3. 页面提供关键词搜索和按生成日期筛选的功能。
        4. 主体区域以列表形式展示所有状态为“待审核”的FAQ，默认按生成时间倒序排列。
        5. 用户找到希望处理的条目，点击该行末尾的【审核】按钮，系统跳转至“审核详情页”(US-02)。
    3.  **异常处理 (Error Handling)**:
        *   如列表加载失败，应给予友好提示，如“数据加载失败，请刷新重试”。
*   **验收标准 (Acceptance Criteria)**:
    *   **场景1: 成功加载并查看列表**
        *   **GIVEN** 系统中有10条待审核的FAQ
        *   **WHEN** 我登录并进入“FAQ审核工作台”
        *   **THEN** 我应该看到顶部的统计数字“待审核总数: 10”，并且列表中正确显示了这10条FAQ的问题摘要和生成时间。
    *   **场景2: 使用搜索功能**
        *   **GIVEN** 待审核列表中有一条问题包含“水费”
        *   **WHEN** 我在搜索框中输入“水费”并点击搜索
        *   **THEN** 列表应只显示问题中包含“水费”的条目。
---
*   **技术实现概要 (Technical Implementation Brief)**:
    *   **影响范围**: Web前端
    *   **前端 / 客户端 (Frontend / Client)**: React/Vue 页面，包含统计卡片、表单筛选区域和数据表格组件。调用后端API `GET /pending-faqs` 获取列表数据。
    *   **页面布局线框图 (ASCII Wireframe)**:
        ```text
        +------------------------------------------------------------------------------------------+
        | FAQ 智能挖掘与扩充系统                                                   [用户: 小张 v] |
        +==========================================================================================+
        | FAQ 审核工作台                                                                           |
        |------------------------------------------------------------------------------------------|
        |                                                                                          |
        |  +------------------------+    +------------------------+                                |
        |  |   待审核总数: 32       |    |   今日新增: 5          |                                |
        |  +------------------------+    +------------------------+                                |
        |                                                                                          |
        |------------------------------------------------------------------------------------------|
        |                                                                                          |
        |  [ 按问题关键词搜索...          ]  生成日期: [YYYY-MM-DD] 至 [YYYY-MM-DD]  [ 搜索 ]    [ 重置 ] |
        |                                                                                          |
        +------------------------------------------------------------------------------------------+
        |                                                                                          |
        |  +-------------------------------------------------------------+------------+----------+  |
        |  | 问题摘要                                                    | 生成时间   | 操作     |  |
        |  +-------------------------------------------------------------+------------+----------+  |
        |  | 如何查询上个月的水费账单？                                  | 2024-10-26 | [ 审核 ] |  |
        |  +-------------------------------------------------------------+------------+----------+  |
        |  | 我家水管漏水了，应该联系哪个部门维修？                        | 2024-10-26 | [ 审核 ] |  |
        |  +-------------------------------------------------------------+------------+----------+  |
        |  ...                                                         | ...        | ...      |  |
        |  +-------------------------------------------------------------+------------+----------+  |
        |                                                                                          |
        |                                         << 上一页 | 第 [ 1 ] 页 / 共 4 页 | 下一页 >>      |
        |                                                                                          |
        +------------------------------------------------------------------------------------------+
        ```
    *   **后端 (Backend)**: 提供 `GET /pending-faqs` 接口，支持按关键词和日期范围进行过滤，并支持分页。
*   **约束与边界 (Constraints & Boundaries)**: 列表分页，每页默认显示20条。

### 阶段二：审核决策

---

#### **US-02: 作为知识库审核员，我希望能方便地比对AI建议和原始对话，以便我能准确地编辑并做出采纳或废弃的决策。**
*   **价值陈述 (Value Statement)**:
    *   **作为** 知识库审核员
    *   **我希望** 在同一个界面上看到可编辑的Q&A和它来源的对话全文
    *   **以便于** 做出有充分依据的审核决策，并确保入库知识的准确性。
*   **业务规则与逻辑 (Business Logic)**:
    1.  **前置条件**: 用户从“FAQ审核工作台”(US-01)点击【审核】按钮进入本页面。
    2.  **操作流程 (Happy Path - 采纳)**:
        1. 页面加载，左侧显示AI建议的问题和答案，右侧显示完整的原始对话参考。
        2. 用户审阅后，认为答案需要优化，于是在左侧的“答案(A)”编辑框中进行修改。
        3. 修改完成后，用户点击页面右下角的【采纳并入库】按钮。
        4. 系统保存修改后的Q&A到正式知识库，并将其状态从未审核更新。
        5. 系统弹出“操作成功”的全局提示，并自动跳转回“FAQ审核工作台”页面。刚刚处理过的条目已从列表中消失。
    3.  **操作流程 (废弃)**:
        1. 用户审阅后，认为该Q&A无价值。
        2. 用户点击【废弃】按钮。
        3. 系统将该条待审核记录标记为废弃。
        4. 系统弹出提示并跳转回“FAQ审核工作台”页面，该条目从列表中消失。
*   **验收标准 (Acceptance Criteria)**:
    *   **场景1: 编辑并采纳**
        *   **GIVEN** 我在审核详情页，并将答案从“A”修改为“B”
        *   **WHEN** 我点击【采纳并入库】
        *   **THEN** 系统应提示成功，我被带回到审核工作台列表页，并且在正式知识库中可以查到一条答案为“B”的新知识。
    *   **场景2: 直接废弃**
        *   **GIVEN** 我在审核详情页，认为内容无用
        *   **WHEN** 我点击【废弃】
        *   **THEN** 系统应提示成功，我被带回到审核工作台列表页，并且该条目已从列表中消失。
---
*   **技术实现概要 (Technical Implementation Brief)**:
    *   **影响范围**: Web前端、后端、数据库
    *   **前端 / 客户端 (Frontend / Client)**: 左右分栏布局。左侧为表单输入框，右侧为只读文本展示区。点击操作按钮时调用后端对应API。
    *   **页面布局线框图 (ASCII Wireframe)**:
        ```text
        +------------------------------------------------------------------------------------------+
        | FAQ 智能挖掘与扩充系统                                                   [用户: 小张 v] |
        +==========================================================================================+
        | [ < 返回列表 ]  审核详情                                                                   |
        |------------------------------------------------------------------------------------------|
        |                                                                                          |
        | +-----------------------------------------+  +-------------------------------------------+ |
        | |        AI 建议内容 (可编辑)           |  |             原始对话参考                  | |
        | +-----------------------------------------+  +-------------------------------------------+ |
        | |                                         |  | 对话ID: CHAT_20241026_114514            | |
        | | 问题 (Q):                               |  | 对话时间: 2024-10-26 15:30:12         | |
        | | +-------------------------------------+ |  |-------------------------------------------| |
        | | | 如何查询个人用水户号？              | |  | +---------------------------------------+ | |
        | | +-------------------------------------+ |  | | | 客服：214号话务员为您服务。           | | |
        | |                                         |  | | | 市民：您好，我想查一下我现在住的房子  | | |
        | | 答案 (A):                               |  | | | ... (内容可滚动)                    | | |
        | | +-------------------------------------+ |  | | +---------------------------------------+ | |
        | | | 提供户主姓名与准确用水地址后...     | |  | +-------------------------------------------+ |
        | | +-------------------------------------+ |  |                                           | |
        | +-----------------------------------------+  +-------------------------------------------+ |
        |                                                                                          |
        |------------------------------------------------------------------------------------------|
        |                                                                                          |
        |                                                     [ 废弃 ]  [ 采纳并入库 ]             |
        |                                                                                          |
        +------------------------------------------------------------------------------------------+
        ```
    *   **后端 (Backend)**: 提供 `POST /knowledge-base` (采纳)、`DELETE /pending-faqs/{id}` (废弃)等接口。
    *   **数据库 / 存储 (Database / Storage)**: `pending_faqs` 表状态更新，`knowledge_items` 表新增数据。
*   **数据模型 / 接口契约 (Data Contracts & APIs)**:
    *   `POST /knowledge-base` 请求体: `{ "question": "...", "answer": "..." }`
*   **约束与边界 (Constraints & Boundaries)**: Q&A内容均为纯文本，不支持富文本格式。

### 阶段三：知识维护

---

#### **US-03: 作为知识库审核员，我希望能对已入库的知识进行管理，以便于保持知识库的准确和现时有效。**
*   **价值陈述 (Value Statement)**:
    *   **作为** 知识库审核员
    *   **我希望** 能搜索、编辑和禁用/启用知识库中的条目
    *   **以便于** 应对业务变化，及时更新或下线过时的知识。
*   **业务规则与逻辑 (Business Logic)**:
    1.  **前置条件**: 用户已登录，并从导航进入“正式知识库管理”页面。
    2.  **操作流程 (查看与搜索)**:
        1. 页面默认展示“已生效”状态的知识列表。
        2. 用户可以使用顶部的搜索框和日期选择器进行筛选。
        3. 用户可以点击“已禁用”页签，切换查看已下线的知识列表。
    3.  **操作流程 (禁用与启用)**:
        1. 在“已生效”列表中，用户点击某条知识后的【禁用】按钮。该条目会移动到“已禁用”列表。
        2. 在“已禁用”列表中，用户点击某条知识后的【启用】按钮。该条目会移回到“已生效”列表。
    4.  **操作流程 (编辑)**: 用户点击【编辑】按钮，系统可以弹出一个模态框（Modal）或跳转到新页面，让用户修改Q&A内容并保存。
*   **验收标准 (Acceptance Criteria)**:
    *   **场景1: 成功禁用一条知识**
        *   **GIVEN** 我在“已生效”列表，该列表有5条知识
        *   **WHEN** 我点击第一条知识的【禁用】按钮
        *   **THEN** “已生效”列表应只剩4条知识，并且“已禁用”列表的计数器会加1。
    *   **场景2: 成功启用一条知识**
        *   **GIVEN** 我在“已禁用”列表，该列表有1条知识
        *   **WHEN** 我点击这条知识的【启用】按钮
        *   **THEN** “已禁用”列表变为空，并且“已生效”列表的计数器会加1。
---
*   **技术实现概要 (Technical Implementation Brief)**:
    *   **影响范围**: Web前端、后端、数据库
    *   **前端 / 客户端 (Frontend / Client)**: 页面包含Tabs组件用于状态切换，以及标准的数据表格和搜索表单。
    *   **页面布局线框图 (ASCII Wireframe)**:
        ```text
        +------------------------------------------------------------------------------------------+
        | FAQ 智能挖掘与扩充系统                                                   [用户: 小张 v] |
        +==========================================================================================+
        | 正式知识库管理                                                                           |
        |------------------------------------------------------------------------------------------|
        |                                                                                          |
        |  [ 按问题或答案关键词搜索...      ]  更新日期: [YYYY-MM-DD] 至 [YYYY-MM-DD]  [ 搜索 ]  [ 重置 ] |
        |                                                                                          |
        +------------------------------------------------------------------------------------------+
        |                                                                                          |
        |   [ 已生效 (256) ]  [ 已禁用 (12) ]                                                      |
        |  +---------------------------------------------------------------------------------------+ |
        |  |                                                                                       | |
        |  | +----------------------+--------------------------+------------+-------------------+ | |
        |  | | 问题                 | 答案摘要                 | 最后更新   | 操作              | | |
        |  | +----------------------+--------------------------+------------+-------------------+ | |
        |  | | 如何查询个人用水户号？ | 提供户主姓名与准确用水地址... | 2024-10-26 | [ 编辑 ] [ 禁用 ] | | |
        |  | +----------------------+--------------------------+------------+-------------------+ | |
        |  | | ...                  | ...                      | ...        | ...               | | |
        |  | +----------------------+--------------------------+------------+-------------------+ | |
        |  |                                                                                       | |
        |  |                                         << 上一页 | 第 [ 1 ] 页 / 共 26 页 | 下一页 >> | |
        |  +---------------------------------------------------------------------------------------+ |
        |                                                                                          |
        +------------------------------------------------------------------------------------------+
        ```
    *   **后端 (Backend)**: 提供 `GET /knowledge-base` 接口，支持按状态、关键词、日期过滤。提供 `PUT /knowledge-base/{id}` 接口用于修改内容和状态。
    *   **数据库 / 存储 (Database / Storage)**: `knowledge_items` 表中需要有 `status` 字段 (e.g., 'active', 'disabled')。
*   **约束与边界 (Constraints & Boundaries)**: 删除操作为逻辑删除（改变状态），而非物理删除。
*   **开放问题与待确认事项 (Open Questions & Follow-ups)**:
    *   **V2.0 探讨**: 是否需要在审核端引入“问题热度/频次”指标，以帮助审核员判断优先级。（责任人：产品经理，跟进时间：V1.0上线后）